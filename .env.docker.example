# MyPalClara Docker Environment Configuration
# Copy this to .env and fill in your values

# ============================================================================
# REQUIRED
# ============================================================================

# OpenAI API key (ALWAYS required for embeddings, even with other LLM providers)
OPENAI_API_KEY=sk-proj-...

# Chat LLM provider: openrouter | nanogpt | openai | anthropic | bedrock | azure
LLM_PROVIDER=openrouter

# --------------------------
# User / Project
# --------------------------
USER_ID=demo-user
DEFAULT_PROJECT=Default Project

# ============================================================================
# LLM PROVIDERS (configure the one matching LLM_PROVIDER above)
# ============================================================================

# --------------------------
# OpenRouter (LLM_PROVIDER=openrouter)
# --------------------------
OPENROUTER_API_KEY=sk-or-...
OPENROUTER_MODEL=anthropic/claude-sonnet-4
# OPENROUTER_SITE=http://localhost:3000
# OPENROUTER_TITLE=MyPalClara

# --------------------------
# Anthropic (LLM_PROVIDER=anthropic)
# Native SDK with native tool calling. Recommended for Claude proxies (clewdr).
# --------------------------
# ANTHROPIC_API_KEY=sk-ant-...
# ANTHROPIC_MODEL=claude-sonnet-4-5
# ANTHROPIC_BASE_URL=              # Optional: for proxies like clewdr

# --------------------------
# NanoGPT (LLM_PROVIDER=nanogpt)
# --------------------------
# NANOGPT_API_KEY=sk-nano-...
# NANOGPT_MODEL=moonshotai/Kimi-K2-Instruct-0905

# --------------------------
# Custom OpenAI-compatible (LLM_PROVIDER=openai)
# --------------------------
# CUSTOM_OPENAI_API_KEY=sk-custom-...
# CUSTOM_OPENAI_BASE_URL=https://api.openai.com/v1
# CUSTOM_OPENAI_MODEL=gpt-4o

# --------------------------
# Amazon Bedrock (LLM_PROVIDER=bedrock)
# Requires langchain-aws package. Supports IAM role auth on AWS.
# --------------------------
# AWS_REGION=us-east-1
# AWS_ACCESS_KEY_ID=...
# AWS_SECRET_ACCESS_KEY=...
# BEDROCK_MODEL=anthropic.claude-3-5-sonnet-20241022-v2:0

# --------------------------
# Azure OpenAI (LLM_PROVIDER=azure)
# --------------------------
# AZURE_OPENAI_ENDPOINT=https://your-resource.openai.azure.com
# AZURE_OPENAI_API_KEY=...
# AZURE_DEPLOYMENT_NAME=your-deployment
# AZURE_API_VERSION=2024-02-15-preview
# AZURE_MODEL=gpt-4o

# --------------------------
# Cloudflare Access (for endpoints behind cloudflared tunnels)
# --------------------------
# CF_ACCESS_CLIENT_ID=...
# CF_ACCESS_CLIENT_SECRET=...

# ============================================================================
# MODEL TIERS
# ============================================================================
# Discord supports !high, !mid, !low prefixes for model selection.
# Each provider has _HIGH, _MID, _LOW variants (e.g. ANTHROPIC_MODEL_HIGH).
# --------------------------
# MODEL_TIER=mid                    # Default tier when not specified
# AUTO_TIER_SELECTION=false          # Auto-select tier based on message complexity

# ============================================================================
# TOOL CALLING
# ============================================================================
# TOOL_CALL_MODE=langchain           # langchain (default) | native | xml

# ============================================================================
# ROOK MEMORY SYSTEM
# ============================================================================

# --------------------------
# Rook LLM provider (independent from chat LLM — used for memory extraction)
# --------------------------
ROOK_PROVIDER=openrouter
ROOK_MODEL=openai/gpt-4o-mini
# ROOK_API_KEY=...                   # Optional: override provider's default key
# ROOK_BASE_URL=...                  # Optional: override provider's default URL

# --------------------------
# Vector Store
# Default: Qdrant (local). Set ROOK_DATABASE_URL for pgvector (production).
# --------------------------
# ROOK_DATABASE_URL=postgresql://clara:clara@localhost:5433/clara_vectors
# ROOK_COLLECTION_NAME=clara_memories
# QDRANT_URL=...                     # Self-hosted Qdrant (takes priority over pgvector)
# QDRANT_API_KEY=...

# --------------------------
# Graph Memory (FalkorDB — relationship tracking)
# --------------------------
ENABLE_GRAPH_MEMORY=false
# GRAPH_STORE_PROVIDER=falkordb
# FALKORDB_HOST=localhost
# FALKORDB_PORT=6379
# FALKORDB_PASSWORD=
# FALKORDB_GRAPH_NAME=clara_memory

# --------------------------
# Memory Caching (Redis)
# --------------------------
# MEMORY_EMBEDDING_CACHE=true
# REDIS_URL=redis://localhost:6379

# ============================================================================
# DATABASE
# ============================================================================

# PostgreSQL (production). Omit for SQLite (development).
# POSTGRES_PASSWORD=clara
# DATABASE_URL=postgresql://clara:clara@localhost:5432/clara_main

# ============================================================================
# GATEWAY
# ============================================================================
# CLARA_GATEWAY_HOST=127.0.0.1
# CLARA_GATEWAY_PORT=18789
# CLARA_GATEWAY_SECRET=...           # Optional shared secret for auth
# CLARA_GATEWAY_URL=ws://127.0.0.1:18789  # Adapter-side connection URL

# --------------------------
# Gateway Tuning
# --------------------------
# MESSAGE_DEBOUNCE_SECONDS=2.0       # Debounce window for group messages
# GATEWAY_MAX_TOOL_ITERATIONS=75     # Max tool call iterations per request
# GATEWAY_LLM_THREADS=10             # Thread pool for LLM calls
# AUTO_CONTINUE_ENABLED=true         # Auto-continue on non-empty tool results
# AUTO_CONTINUE_MAX=3                # Max auto-continue iterations

# --------------------------
# Target Classifier (group channels)
# Determines if a message is directed at Clara before processing.
# --------------------------
# TARGET_CLASSIFIER=true             # Enabled by default for group channels

# ============================================================================
# DISCORD BOT
# ============================================================================
# Create a bot at https://discord.com/developers/applications
# Enable MESSAGE CONTENT INTENT in Bot settings

# DISCORD_BOT_TOKEN=your-bot-token

# Optional: restrict to specific servers/channels (comma-separated IDs)
# DISCORD_ALLOWED_SERVERS=123456789
# DISCORD_ALLOWED_CHANNELS=123456789,987654321
# DISCORD_ALLOWED_ROLES=123456789

# Optional: conversation settings
# DISCORD_MAX_MESSAGES=25
# DISCORD_STOP_PHRASES=clara stop,stop clara,nevermind

# ============================================================================
# MICROSOFT TEAMS
# ============================================================================
# TEAMS_APP_ID=...                   # Azure Bot registration App ID
# TEAMS_APP_PASSWORD=...             # Azure Bot registration password
# TEAMS_APP_TYPE=MultiTenant         # MultiTenant | SingleTenant | ManagedIdentity
# TEAMS_PORT=3978

# ============================================================================
# SANDBOX (Code Execution)
# ============================================================================
# SANDBOX_MODE=auto                  # docker | incus | incus-vm | auto

# Docker sandbox
# DOCKER_SANDBOX_IMAGE=python:3.12-slim
# DOCKER_SANDBOX_TIMEOUT=900         # Idle timeout in seconds
# DOCKER_SANDBOX_MEMORY=512m
# DOCKER_SANDBOX_CPU=1.0

# Incus sandbox
# INCUS_SANDBOX_IMAGE=images:debian/12/cloud
# INCUS_SANDBOX_TYPE=container       # container | vm
# INCUS_SANDBOX_TIMEOUT=900
# INCUS_SANDBOX_MEMORY=512MiB

# GitHub token (for sandbox git operations)
# GITHUB_TOKEN=ghp_...

# ============================================================================
# MCP PLUGINS
# ============================================================================
# MCP_SERVERS_DIR=.mcp_servers
# SMITHERY_API_KEY=...               # Smithery registry access

# ============================================================================
# WEB SEARCH
# ============================================================================
# TAVILY_API_KEY=tvly-...            # https://tavily.com

# ============================================================================
# EMAIL MONITORING
# ============================================================================
# EMAIL_MONITORING_ENABLED=false
# CLARA_EMAIL_ADDRESS=...
# CLARA_EMAIL_PASSWORD=...
# CLARA_IMAP_SERVER=imap.titan.email
# CLARA_SMTP_SERVER=smtp.titan.email

# ============================================================================
# BOT PERSONALITY
# ============================================================================
# BOT_NAME=Clara                     # Extracted from personality file if not set
# BOT_PERSONALITY_FILE=...           # Path to personality .txt file

# ============================================================================
# S3-COMPATIBLE STORAGE (Wasabi, AWS, MinIO)
# ============================================================================
# S3_ENABLED=false
# S3_BUCKET=clara-files
# S3_ENDPOINT_URL=https://s3.wasabisys.com
# S3_ACCESS_KEY=...
# S3_SECRET_KEY=...
# S3_REGION=us-east-1

# ============================================================================
# LOGGING
# ============================================================================
# LOG_LEVEL=INFO
# DEFAULT_TIMEZONE=America/New_York
